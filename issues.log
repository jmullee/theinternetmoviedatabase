## compile issues

	script -c 'make compile' make-compile.log
	grep -iE 'warning|error' make-compile.log | cut -d: -f 4- | sort | uniq -c
		  1  warning: ‘__builtin___sprintf_chk’ may write a terminating nul past the end of the destination [-Wformat-overflow=]
		  3  warning: ‘ ’ directive writing 1 byte into a region of size between 0 and 699 [-Wformat-overflow=]
		 14  warning: format ‘%d’ expects argument of type ‘int’, but argument 2 has type ‘TitleID’ {aka ‘long unsigned int’} [-Wformat=]
		  1  warning: format not a string literal and no format arguments [-Wformat-security]
		  1  warning: format ‘%x’ expects argument of type ‘unsigned int’, but argument 4 has type ‘TitleID’ {aka ‘long unsigned int’} [-Wformat=]
		 38  warning: ignoring return value of ‘fgets’, declared with attribute warn_unused_result [-Wunused-result]
		  1  warning: implicit declaration of function ‘vmrrLindexSort’; did you mean ‘smrrLindexSort’? [-Wimplicit-function-declaration]
		  1  warning: return type defaults to ‘int’ [-Wimplicit-int]
		  4  warning: ‘%s’ directive writing up to 699 bytes into a region of size 697 [-Wformat-overflow=]
		  1  warning: too many arguments for format [-Wformat-extra-args]

## run issues (with lists trimmed to 50k lines: ./lists/get_smol_lists.sh)

	make cleandbs ; script -c 'make databases' make-databases.log
	grep -niE -B 3 -A 1 'core dumped' make-databases.log | grep -v 'ing directory'
		23-/home/jmullee/projects/imdb/moviedb/src/etc/mkdb  -acs
		24-Adding Actresses...
		25:make[3]: *** [/tmp/make.2266899:2: actresses.data] Segmentation fault (core dumped)
		26-make[3]: *** Deleting file 'actresses.data'
		--
		44-/home/jmullee/projects/imdb/moviedb/src/etc/mkdb  -write
		45-Adding Writers...
		46-*** stack smashing detected ***: terminated
		47:make[3]: *** [/tmp/make.2266937:2: writers.data] Aborted (core dumped)
		48-make[3]: *** Deleting file 'writers.data'
		--
		84-/home/jmullee/projects/imdb/moviedb/src/etc/mkdb  -naka
		85-Adding Aka Names...
		86:make[3]: *** [/tmp/make.2266998:2: aka-names.data] Segmentation fault (core dumped)

## output issues

	## empty db files

		find dbs -type f -size 0 | xargs ls -l
			# due to Segmentation fault
				-rw-r----- 1 jmullee jmullee 0 Oct 19 21:02 dbs/actresses.data
				-rw-r----- 1 jmullee jmullee 0 Oct 19 21:02 dbs/actresses.names
				-rw-r----- 1 jmullee jmullee 0 Oct 19 21:02 dbs/actresses.titles
				-rw-r----- 1 jmullee jmullee 0 Oct 19 21:02 dbs/aka-names.data
				-rw-r----- 1 jmullee jmullee 0 Oct 19 21:02 dbs/aka-names.index
				-rw-r----- 1 jmullee jmullee 0 Oct 19 21:02 dbs/writers.data
				-rw-r----- 1 jmullee jmullee 0 Oct 19 21:02 dbs/writers.titles
			# cause ?
				-rw-r----- 1 jmullee jmullee 0 Oct 19 21:01 dbs/keywords.data
				-rw-r----- 1 jmullee jmullee 0 Oct 19 21:01 dbs/keywords.index
				-rw-r----- 1 jmullee jmullee 0 Oct 19 21:02 dbs/names.index
				-rw-r----- 1 jmullee jmullee 0 Oct 19 21:00 dbs/soundtracks.data
				-rw-r----- 1 jmullee jmullee 0 Oct 19 21:00 dbs/soundtracks.index
				-rw-r----- 1 jmullee jmullee 0 Oct 19 21:02 dbs/special-effects-companies.data
				-rw-r----- 1 jmullee jmullee 0 Oct 19 21:02 dbs/special-effects-companies.index
			# is expected: no input data
				-rw-r----- 1 jmullee jmullee 0 Oct 19 21:01 dbs/votes.data

	## included data-header

		for F in dbs/* ; do echo "== $F ==" ; hexdump -C $F | head -n 3 ; done
		(selected:)
			== dbs/biographies.data ==
			00000000  42 49 4f 47 52 41 50 48  59 20 4c 49 53 54 0a 3d  |BIOGRAPHY LIST.=|
			00000010  3d 3d 3d 3d 3d 3d 3d 3d  3d 3d 3d 3d 3d 0a 4e 4d  |=============.NM|
			00000020  3a 20 22 47 68 6f 73 74  22 2c 20 4d 61 74 74 68  |: "Ghost", Matth|
			== dbs/business.data ==
			00000000  42 55 53 49 4e 45 53 53  20 4c 49 53 54 0a 3d 3d  |BUSINESS LIST.==|
			00000010  3d 3d 3d 3d 3d 3d 3d 3d  3d 3d 3d 0a 0a 4d 56 3a  |===========..MV:|
			00000020  20 43 61 72 6d 65 6e 63  69 74 61 20 28 31 38 39  | Carmencita (189|
			== dbs/laserdisc.data ==
			00000000  4c 41 53 45 52 44 49 53  43 20 4c 49 53 54 0a 3d  |LASERDISC LIST.=|
			00000010  3d 3d 3d 3d 3d 3d 3d 3d  3d 3d 3d 3d 3d 0a 2d 2d  |=============.--|
			00000020  0a 4f 54 3a 20 0a 0a 4c  4e 3a 20 33 0a 4c 42 3a  |.OT: ..LN: 3.LB:|
			== dbs/literature.data ==
			00000000  4c 49 54 45 52 41 54 55  52 45 20 4c 49 53 54 0a  |LITERATURE LIST.|
			00000010  3d 3d 3d 3d 3d 3d 3d 3d  3d 3d 3d 3d 3d 3d 3d 0a  |===============.|
			00000020  4d 4f 56 49 3a 20 22 23  56 61 6e 4c 69 66 65 41  |MOVI: "#VanLifeA|
			== dbs/plot.data ==
			00000000  50 4c 4f 54 20 53 55 4d  4d 41 52 49 45 53 20 4c  |PLOT SUMMARIES L|
			00000010  49 53 54 0a 3d 3d 3d 3d  3d 3d 3d 3d 3d 3d 3d 3d  |IST.============|
			00000020  3d 3d 3d 3d 3d 3d 3d 0a  4d 56 3a 20 22 23 37 44  |=======.MV: "#7D|

## fixes..

	display.c:813:42: warning: ‘%s’ directive writing up to 699 bytes into a region of size 697 [-Wformat-overflow=]
		JM: increase length of sprintf target array
	src/display.c:*:42: warning: ‘ ’ directive writing 1 byte into a region of size between 0 and 699 [-Wformat-overflow=]
		JM: increase length of sprintf target array
	src/templist.l:511:9: warning: format not a string literal and no format arguments [-Wformat-security]
		JM: printf( examples[heading]); -> printf("%s\n", examples[heading]);
	src/mkdb.c:295:37: warning: format ‘%x’ expects argument of type ‘unsigned int’, but argument 4 has type ‘TitleID’ {aka ‘long unsigned int’} [-Wformat=]
	src/mkdb.c:*:27: warning: format ‘%d’ expects argument of type ‘int’, but argument 2 has type ‘TitleID’ {aka ‘long unsigned int’} [-Wformat=]
		JM: unsigned long (uint64_t) = AttributeID, NameID, TitleID
			"%s|%x\n" used in index files read by line, so length not critical
			typical read-back-in pattern is
				#define FSEP '|'
				keyptr = strchr(line, FSEP));
				*keyptr++ = '\0' ;
				rec->title = strdup(line);
				rec->titleKey = strtol(keyptr, (char **)NULL, 16);
			should be ok
				- (void) fprintf ( indexFp , "%s|%x\n", titles[i].title, titles[i].titleKey );
				+ (void) fprintf ( indexFp , "%s|%lx\n", titles[i].title, titles[i].titleKey );
			terminal output, not important
				- (void) printf ( " ...%d read\n", count ) ;
				+ (void) printf ( " ...%lu read\n", count ) ;
	src/lindex.c:226:14: warning: implicit declaration of function ‘vmrrLindexSort’; did you mean ‘smrrLindexSort’? [-Wimplicit-function-declaration]
		  JM: add forward declaration
	src/templist.l:131:1: warning: return type defaults to ‘int’ [-Wimplicit-int]
		JM: main( void ) -> int main( void )
	src/mkdb.c:2813:33: warning: too many arguments for format [-Wformat-extra-args]
		JM: fprintf(dbFp, "--\n", line);
		JM: processLaserDiscList: change to match processBusinessList + processLiteratureList,
			which it otherwise exactly resembles. might be a mistake.
	src/display.c:*:42: warning: ‘%s’ directive writing up to 699 bytes into a region of size 697 [-Wformat-overflow=]
		JM: increase length of sprintf target array
	src/*.c:*: warning: ignoring return value of ‘fgets’, declared with attribute warn_unused_result [-Wunused-result]
		JM: ADD ERROR-HANDLING CODE

###############################################################

	make cleanobj cleanbin ; script -c 'make compile installbin' make-compile.log
	grep -iE 'warning|error' make-compile.log | cut -d: -f 4- | sort | uniq -c

		-Wunused-value				1
		-Wunused-function			4
			templist.c yacc stuff

		-Wunused-but-set-variable	4

			display.c:919:28: warning: variable ‘subgroupPrev’ set but not used [-Wunused-but-set-variable]
			  919 |   int linePrev, groupPrev, subgroupPrev ;
			lindex.c:85:29: warning: variable ‘result’ set but not used [-Wunused-but-set-variable]
			   85 |   char line [ MXLINELEN ], *result = NULL;
			mkdb.c:1902:23: warning: variable ‘skipMode’ set but not used [-Wunused-but-set-variable]
			 1902 |   int  inbio = FALSE, skipMode = FALSE, compare ;
			mkdb.c:2429:39: warning: variable ‘skipMode’ set but not used [-Wunused-but-set-variable]
			 2429 |   int inaka = FALSE, enddata = FALSE, skipMode, compare ;

		-Wdangling-else				13
		-Wpointer-sign				122


	make cleandbs ; script -c 'make databases' make-databases.log
	grep -aniEC4 'fault|dumped|terminated|smashing|fail|error|corrupt' make-databases.log | grep -vE 'WARNING|ing directory' | uniq
		23-/home/jmullee/projects/imdb/moviedb/src/etc/mkdb  -acs
		24-Adding Actresses...
		25:make[3]: *** [/tmp/make.64208:2: actresses.data] Segmentation fault (core dumped)
		26-make[3]: *** Deleting file 'actresses.data'
		29-/home/jmullee/projects/imdb/moviedb/src/etc/mkdb  -cine
		--
		44-/home/jmullee/projects/imdb/moviedb/src/etc/mkdb  -write
		45-Adding Writers...
		46:*** stack smashing detected ***: terminated
		47:make[3]: *** [/tmp/make.64263:2: writers.data] Aborted (core dumped)
		48-make[3]: *** Deleting file 'writers.data'
		51-/home/jmullee/projects/imdb/moviedb/src/etc/mkdb  -edit
		--
		12932-/home/jmullee/projects/imdb/moviedb/src/etc/mkdb  -naka
		12933-Adding Aka Names...
		12934:make[3]: *** [/tmp/make.64314:2: aka-names.data] Segmentation fault (core dumped)
		12937-/home/jmullee/projects/imdb/moviedb/src/etc/mkdb  -plot
		12938-Adding Plot Summaries...
		--
		13088-Adding Distributor List...
		13089- ...49986 read
		13091-/home/jmullee/projects/imdb/moviedb/src/etc/mkdb  -create
		13092:mkdb: key file corrupt
		13093:make[2]: *** [Makefile:117: touch-dbs] Error 255
		13095:make[1]: *** [Makefile:317: do-databases] Error 2
		13097:make: *** [Makefile:311: databases] Error 2
		13098-
		13099-Script done on 2024-10-20 21:22:26+01:00 [COMMAND_EXIT_CODE="2"]
